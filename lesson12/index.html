<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FireCareer Log - Ê∂àÈò≤ËÅ∑Âì°Â±•Ê≠¥ÁÆ°ÁêÜ</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel (for JSX) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        /* Âç∞Âà∑ÊôÇ„ÅÆÁâπÂà•„É´„Éº„É´ */
        @media print {
            body * {
                visibility: hidden;
            }
            .print-area, .print-area * {
                visibility: visible;
            }
            .print-area {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                margin: 0;
                padding: 20px;
                background: white;
            }
            header, button, .no-print {
                display: none !important;
            }
        }
    </style>
</head>
<body class="bg-slate-100 text-slate-800">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- „Ç¢„Ç§„Ç≥„É≥„Ç≥„É≥„Éù„Éº„Éç„É≥„Éà (Lucide-ReactÁõ∏ÂΩì„ÇíËªΩÈáèÂÆüË£Ö) ---
        const IconBase = ({ children, size = 24, className = "" }) => (
            <svg 
                xmlns="http://www.w3.org/2000/svg" 
                width={size} 
                height={size} 
                viewBox="0 0 24 24" 
                fill="none" 
                stroke="currentColor" 
                strokeWidth="2" 
                strokeLinecap="round" 
                strokeLinejoin="round" 
                className={className}
            >
                {children}
            </svg>
        );

        const Shield = (props) => <IconBase {...props}><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></IconBase>;
        const FileText = (props) => <IconBase {...props}><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/></IconBase>;
        const Printer = (props) => <IconBase {...props}><polyline points="6 9 6 2 18 2 18 9"/><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"/><rect x="6" y="14" width="12" height="8"/></IconBase>;
        const Trash2 = (props) => <IconBase {...props}><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/><line x1="10" y1="11" x2="10" y2="17"/><line x1="14" y1="11" x2="14" y2="17"/></IconBase>;
        const Copy = (props) => <IconBase {...props}><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></IconBase>;
        const BookOpen = (props) => <IconBase {...props}><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 1-4 4v14a3 3 0 0 1 3-3h7z"/></IconBase>;
        const Award = (props) => <IconBase {...props}><circle cx="12" cy="8" r="7"/><polyline points="8.21 13.89 7 23 12 20 17 23 15.79 13.88"/></IconBase>;
        const BadgeCheck = (props) => <IconBase {...props}><path d="M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.78 4.78 4 4 0 0 1-6.74 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z"/><path d="m9 12 2 2 4-4"/></IconBase>;
        const Building = (props) => <IconBase {...props}><rect x="4" y="2" width="16" height="20" rx="2" ry="2"/><line x1="9" y1="22" x2="9" y2="22.01"/><line x1="15" y1="22" x2="15" y2="22.01"/><line x1="9" y1="18" x2="9" y2="18.01"/><line x1="15" y1="18" x2="15" y2="18.01"/><line x1="9" y1="14" x2="9" y2="14.01"/><line x1="15" y1="14" x2="15" y2="14.01"/><line x1="9" y1="10" x2="9" y2="10.01"/><line x1="15" y1="10" x2="15" y2="10.01"/><line x1="9" y1="6" x2="9" y2="6.01"/><line x1="15" y1="6" x2="15" y2="6.01"/></IconBase>;
        const User = (props) => <IconBase {...props}><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></IconBase>;
        const AlertTriangle = (props) => <IconBase {...props}><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></IconBase>;
        const ArrowLeft = (props) => <IconBase {...props}><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></IconBase>;

        // --- ÂÆöÊï∞ ---
        const RANKS = [
            "Ê∂àÈò≤Â£´", "Ê∂àÈò≤ÂâØÂ£´Èï∑", "Ê∂àÈò≤Â£´Èï∑", 
            "Ê∂àÈò≤Âè∏‰ª§Ë£ú", "Ê∂àÈò≤Âè∏‰ª§", "Ê∂àÈò≤Âè∏‰ª§Èï∑", 
            "Ê∂àÈò≤Áõ£", "Ê∂àÈò≤Ê≠£Áõ£", "Ê∂àÈò≤Âè∏Áõ£"
        ];

        const ADMIN_TITLES = [
            "„Å™„Åó", "‰∏ª‰∫ã", "‰∏ª‰ªª", "‰∏ªÊüª", "‰øÇÈï∑", 
            "‰∏ªÂππ", "Ë™≤Èï∑Ë£ú‰Ωê", "Ë™≤Èï∑", "Ê¨°Èï∑", "ÈÉ®Èï∑", "Â±ÄÈï∑"
        ];

        const MAX_YEARS = 47;

        // IDÁîüÊàê„Éò„É´„Éë„Éº
        const generateId = () => {
            return Date.now().toString(36) + Math.random().toString(36).substr(2, 9);
        };

        // --- „Éò„É´„Éë„ÉºÈñ¢Êï∞ ---
        function getWareki(year) {
            if (year >= 2019) {
                const y = year - 2018;
                return `‰ª§Âíå${y === 1 ? 'ÂÖÉ' : y}`;
            }
            if (year >= 1989) {
                const y = year - 1988;
                return `Âπ≥Êàê${y === 1 ? 'ÂÖÉ' : y}`;
            }
            if (year >= 1926) {
                const y = year - 1925;
                return `Êò≠Âíå${y === 1 ? 'ÂÖÉ' : y}`;
            }
            return year;
        }

        function formatDateJP(dateString) {
            if (!dateString) return "";
            const d = new Date(dateString);
            const year = d.getFullYear();
            const month = d.getMonth() + 1;
            const day = d.getDate();
            
            const wareki = getWareki(year);
            return `${year}Âπ¥Ôºà${wareki}Âπ¥Ôºâ${month}Êúà${day}Êó•`;
        }

        // --- „É°„Ç§„É≥„Ç≥„É≥„Éù„Éº„Éç„É≥„Éà ---
        function FireCareerLog() {
            const [activeTab, setActiveTab] = useState('list');
            const [profile, setProfile] = useState({
                name: '',
                hireDate: '',
                currentOrg: ''
            });
            
            const [history, setHistory] = useState([]);
            const [isInitialized, setIsInitialized] = useState(false);
            
            const [editModalOpen, setEditModalOpen] = useState(false);
            const [currentEditItem, setCurrentEditItem] = useState(null);
            const [deleteConfirmOpen, setDeleteConfirmOpen] = useState(false);

            useEffect(() => {
                try {
                    const savedProfile = localStorage.getItem('fireCareer_profile');
                    const savedHistory = localStorage.getItem('fireCareer_history');
                    
                    if (savedProfile) {
                        setProfile(JSON.parse(savedProfile));
                        setIsInitialized(true);
                    }
                    if (savedHistory) {
                        setHistory(JSON.parse(savedHistory));
                    }
                } catch (e) {
                    console.error("LocalStorage Access Error", e);
                }
            }, []);

            const saveData = (newProfile, newHistory) => {
                try {
                    if (newProfile) {
                        setProfile(newProfile);
                        localStorage.setItem('fireCareer_profile', JSON.stringify(newProfile));
                    }
                    if (newHistory) {
                        setHistory(newHistory);
                        localStorage.setItem('fireCareer_history', JSON.stringify(newHistory));
                    }
                } catch (e) {
                    alert("‰øùÂ≠ò„Å´Â§±Êïó„Åó„Åæ„Åó„Åü„ÄÇ„Éñ„É©„Ç¶„Ç∂„ÅÆË®≠ÂÆö„ÇíÁ¢∫Ë™ç„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ");
                }
            };

            const initializeHistory = () => {
                if (!profile.name || !profile.hireDate) {
                    alert("Ê∞èÂêç„Å®ÊãùÂëΩÂπ¥ÊúàÊó•„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ");
                    return;
                }

                const hireDateObj = new Date(profile.hireDate);
                let startYear = hireDateObj.getFullYear();
                if (hireDateObj.getMonth() < 3) {
                    startYear -= 1; 
                }

                const newHistory = [];
                for (let i = 0; i < MAX_YEARS; i++) {
                    newHistory.push({
                        id: generateId(),
                        yearIndex: i + 1,
                        fiscalYear: startYear + i,
                        orgName: i === 0 ? profile.currentOrg : '',
                        rank: i === 0 ? 'Ê∂àÈò≤Â£´' : '',
                        adminTitle: '‰∏ª‰∫ã',
                        department: '',
                        section: '',
                        events: i === 0 ? 'ÊãùÂëΩ' : '',
                        awards: '',
                        licenses: '',
                    });
                }
                
                saveData(profile, newHistory);
                setIsInitialized(true);
                switchTab('list');
            };

            const switchTab = (tabName) => {
                setActiveTab(tabName);
                window.scrollTo(0, 0);
            };

            const openEditModal = (item) => {
                setCurrentEditItem({ ...item });
                setEditModalOpen(true);
            };

            const saveEdit = () => {
                const updatedHistory = history.map(item => 
                    item.id === currentEditItem.id ? currentEditItem : item
                );
                saveData(null, updatedHistory);
                setEditModalOpen(false);
            };

            const copyFromPrevious = (index) => {
                if (index === 0) return;
                const prev = history[index - 1];
                const current = history[index];
                
                const newItem = {
                    ...current,
                    orgName: prev.orgName,
                    rank: prev.rank,
                    adminTitle: prev.adminTitle,
                    department: prev.department,
                    section: prev.section,
                };
                
                const updatedHistory = [...history];
                updatedHistory[index] = newItem;
                saveData(null, updatedHistory);
            };

            const executeReset = () => {
                try {
                    localStorage.removeItem('fireCareer_profile');
                    localStorage.removeItem('fireCareer_history');
                } catch (e) {}
                setProfile({ name: '', hireDate: '', currentOrg: '' });
                setHistory([]);
                setIsInitialized(false);
                setDeleteConfirmOpen(false);
            };

            const handlePrint = () => {
                window.print();
            };

            if (!isInitialized) {
                return (
                    <div className="min-h-screen bg-slate-50 flex items-center justify-center p-4 font-sans text-slate-800">
                        <div className="max-w-md w-full bg-white rounded-xl shadow-lg p-8 border border-slate-200">
                            <div className="text-center mb-8">
                                <div className="mx-auto bg-orange-600 w-16 h-16 rounded-full flex items-center justify-center mb-4 text-white">
                                    <Shield size={32} />
                                </div>
                                <h1 className="text-2xl font-bold text-slate-800">FireCareer Log</h1>
                                <p className="text-slate-500 mt-2">Ê∂àÈò≤ËÅ∑Âì°„ÅÆ„Åü„ÇÅ„ÅÆÂ±•Ê≠¥ÁÆ°ÁêÜ„Ç¢„Éó„É™</p>
                            </div>
                            
                            <div className="space-y-4">
                                <div>
                                    <label className="block text-sm font-medium text-slate-700 mb-1">Ê∞èÂêç</label>
                                    <input 
                                        type="text" 
                                        className="w-full p-2 border border-slate-300 rounded focus:ring-2 focus:ring-orange-500 outline-none"
                                        placeholder="Ê∂àÈò≤ Â§™ÈÉé"
                                        value={profile.name}
                                        onChange={(e) => setProfile({...profile, name: e.target.value})}
                                    />
                                </div>
                                <div>
                                    <label className="block text-sm font-medium text-slate-700 mb-1">ÊãùÂëΩÂπ¥ÊúàÊó•</label>
                                    <input 
                                        type="date" 
                                        className="w-full p-2 border border-slate-300 rounded focus:ring-2 focus:ring-orange-500 outline-none"
                                        value={profile.hireDate}
                                        onChange={(e) => setProfile({...profile, hireDate: e.target.value})}
                                    />
                                    <p className="text-xs text-slate-500 mt-1">‚Äª„Åì„Åì„Åã„Çâ47Âπ¥ÂàÜ„ÅÆÂπ¥Â∫¶Êû†„Çí‰ΩúÊàê„Åó„Åæ„Åô</p>
                                </div>
                                <div>
                                    <label className="block text-sm font-medium text-slate-700 mb-1">ÊãùÂëΩÊôÇ„ÅÆÊ∂àÈò≤Êú¨ÈÉ®Âêç</label>
                                    <input 
                                        type="text" 
                                        className="w-full p-2 border border-slate-300 rounded focus:ring-2 focus:ring-orange-500 outline-none"
                                        placeholder="‰æãÔºö„Äá„ÄáÂ∏ÇÊ∂àÈò≤Êú¨ÈÉ®"
                                        value={profile.currentOrg}
                                        onChange={(e) => setProfile({...profile, currentOrg: e.target.value})}
                                    />
                                </div>
                                
                                <button 
                                    onClick={initializeHistory}
                                    className="w-full bg-orange-600 hover:bg-orange-700 text-white font-bold py-3 rounded-lg transition shadow-md mt-4"
                                >
                                    Â±•Ê≠¥ÁÆ°ÁêÜ„ÇíÈñãÂßã„Åô„Çã
                                </button>
                            </div>
                        </div>
                    </div>
                );
            }

            return (
                <div className="min-h-screen bg-slate-100 font-sans text-slate-800">
                    <header className="bg-slate-900 text-white shadow-md sticky top-0 z-10 print:hidden">
                        <div className="max-w-7xl mx-auto px-4 py-3 flex justify-between items-center">
                            <div className="flex items-center gap-3">
                                <Shield className="text-orange-500" />
                                <div>
                                    <h1 className="font-bold text-lg leading-tight">FireCareer Log</h1>
                                    <p className="text-xs text-slate-400">{profile.name} / {formatDateJP(profile.hireDate)} ÊãùÂëΩ</p>
                                </div>
                            </div>
                            <div className="flex gap-2">
                                <button 
                                    onClick={() => switchTab('list')}
                                    className={`px-3 py-1.5 rounded text-sm flex items-center gap-1 ${activeTab === 'list' ? 'bg-orange-600 text-white' : 'hover:bg-slate-800 text-slate-300'}`}
                                >
                                    <FileText size={16} /> <span className="hidden sm:inline">Â±•Ê≠¥‰∏ÄË¶ß</span>
                                </button>
                                <button 
                                    onClick={() => switchTab('print')}
                                    className={`px-3 py-1.5 rounded text-sm flex items-center gap-1 ${activeTab === 'print' ? 'bg-orange-600 text-white' : 'hover:bg-slate-800 text-slate-300'}`}
                                >
                                    <Printer size={16} /> <span className="hidden sm:inline">Âç∞Âà∑„Éó„É¨„Éì„É•„Éº</span>
                                </button>
                                <button 
                                    onClick={() => setDeleteConfirmOpen(true)}
                                    className="px-3 py-1.5 rounded text-sm flex items-center gap-1 hover:bg-red-900 text-red-300 ml-2"
                                    title="„Éá„Éº„Çø„ÇíÂàùÊúüÂåñ"
                                >
                                    <Trash2 size={16} />
                                </button>
                            </div>
                        </div>
                    </header>

                    <main className="max-w-7xl mx-auto p-4 print:p-0">
                        {activeTab === 'list' && (
                            <div className="space-y-4 print:hidden">
                                <div className="bg-white p-4 rounded-lg shadow-sm border border-slate-200 flex justify-between items-center flex-wrap gap-4">
                                    <p className="text-sm text-slate-600">
                                        <span className="font-bold text-orange-600">‚Äª‰Ωø„ÅÑÊñπÔºö</span> 
                                        „Ç´„Éº„Éâ„Çí„ÇØ„É™„ÉÉ„ÇØ„Åó„Å¶Á∑®ÈõÜ„ÄÇ„ÄåÂâçÂπ¥„Ç≥„Éî„Éº„Äç„ÅßÂÖ•Âäõ„ÇíÁúÅÁï•„Åß„Åç„Åæ„Åô„ÄÇ
                                    </p>
                                </div>

                                <div className="grid grid-cols-1 gap-4">
                                    {history.map((item, index) => (
                                        <div 
                                            key={item.id} 
                                            className={`bg-white rounded-lg shadow-sm border-l-4 transition-all hover:shadow-md ${
                                                item.awards ? 'border-l-yellow-400 bg-yellow-50/30' : 
                                                item.licenses ? 'border-l-green-400 bg-green-50/30' :
                                                item.events ? 'border-l-blue-400' : 'border-l-slate-300'
                                            }`}
                                        >
                                            <div className="p-4 flex flex-col sm:flex-row gap-4">
                                                <div className="sm:w-36 flex-shrink-0 border-b sm:border-b-0 sm:border-r border-slate-100 pb-2 sm:pb-0 sm:pr-4">
                                                    <div className="flex items-baseline gap-2 sm:block">
                                                        <span className="text-2xl font-bold text-slate-700">{item.yearIndex}<span className="text-sm font-normal text-slate-500">Âπ¥ÁõÆ</span></span>
                                                        <div className="mt-1">
                                                            <span className="text-sm font-bold text-slate-700 block">
                                                                {getWareki(item.fiscalYear)}Âπ¥Â∫¶
                                                            </span>
                                                            <span className="text-xs text-slate-400 block">
                                                                ({item.fiscalYear}Âπ¥Â∫¶)
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div className="flex-grow cursor-pointer group" onClick={() => openEditModal(item)}>
                                                    <div className="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-2">
                                                        <div className="flex flex-wrap gap-2 items-center">
                                                            <span className="font-bold text-lg text-slate-800">
                                                                {item.orgName || <span className="text-slate-300 font-normal italic">ÁµÑÁπîÂêçÊú™Ë®≠ÂÆö</span>}
                                                            </span>
                                                            {(item.department || item.section) && (
                                                                <span className="text-slate-600 bg-slate-100 px-2 py-1 rounded text-sm">
                                                                    {item.department} {item.section}
                                                                </span>
                                                            )}
                                                        </div>
                                                        <div className="flex gap-2 mt-2 sm:mt-0 text-sm">
                                                            {item.rank && (
                                                                <span className="px-2 py-1 bg-blue-100 text-blue-800 rounded border border-blue-200">
                                                                    {item.rank}
                                                                </span>
                                                            )}
                                                            {item.adminTitle && item.adminTitle !== '„Å™„Åó' && (
                                                                <span className="px-2 py-1 bg-green-100 text-green-800 rounded border border-green-200">
                                                                    {item.adminTitle}
                                                                </span>
                                                            )}
                                                        </div>
                                                    </div>

                                                    {(item.events || item.awards || item.licenses) ? (
                                                        <div className="space-y-1 mt-3">
                                                            {item.events && (
                                                                <div className="flex items-start gap-2 text-sm text-blue-700">
                                                                    <BookOpen size={16} className="mt-0.5 flex-shrink-0" />
                                                                    <span>{item.events}</span>
                                                                </div>
                                                            )}
                                                            {item.awards && (
                                                                <div className="flex items-start gap-2 text-sm text-yellow-700 font-semibold">
                                                                    <Award size={16} className="mt-0.5 flex-shrink-0" />
                                                                    <span>{item.awards}</span>
                                                                </div>
                                                            )}
                                                            {item.licenses && (
                                                                <div className="flex items-start gap-2 text-sm text-green-700 font-semibold">
                                                                    <BadgeCheck size={16} className="mt-0.5 flex-shrink-0" />
                                                                    <span>{item.licenses}</span>
                                                                </div>
                                                            )}
                                                        </div>
                                                    ) : (
                                                        <div className="h-6 flex items-center">
                                                            <span className="text-xs text-slate-300 group-hover:text-slate-400 transition-colors">„ÇØ„É™„ÉÉ„ÇØ„Åó„Å¶Ë©≥Á¥∞„ÇíÂÖ•Âäõ...</span>
                                                        </div>
                                                    )}
                                                </div>

                                                <div className="flex sm:flex-col gap-2 border-t sm:border-t-0 sm:border-l border-slate-100 pt-2 sm:pt-0 sm:pl-4 justify-center">
                                                    <button 
                                                        onClick={(e) => { e.stopPropagation(); openEditModal(item); }}
                                                        className="p-2 text-slate-500 hover:text-orange-600 hover:bg-orange-50 rounded"
                                                        title="Á∑®ÈõÜ"
                                                    >
                                                        <FileText size={18} />
                                                    </button>
                                                    {index > 0 && (
                                                        <button 
                                                            onClick={(e) => { e.stopPropagation(); copyFromPrevious(index); }}
                                                            className="p-2 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded"
                                                            title="ÂâçÂπ¥„Çí„Ç≥„Éî„Éº"
                                                        >
                                                            <Copy size={18} />
                                                        </button>
                                                    )}
                                                </div>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}

                        {activeTab === 'print' && (
                            <div className="bg-white p-8 shadow-lg max-w-4xl mx-auto print-area">
                                <div className="text-center mb-8 border-b-2 border-double border-slate-800 pb-4">
                                    <h2 className="text-3xl font-serif font-bold text-slate-900 mb-2">Â±•Ê≠¥‰∫ãÈ†Ö‰∏ÄË¶ß</h2>
                                    <div className="flex justify-between items-end mt-4 px-4">
                                        <div className="text-left">
                                            <p className="text-sm text-slate-600">Ê∞èÂêç</p>
                                            <p className="text-xl font-bold border-b border-slate-400 px-2 min-w-[200px]">{profile.name}</p>
                                        </div>
                                        <div className="text-right">
                                           <p className="text-sm text-slate-600">ÊãùÂëΩÂπ¥ÊúàÊó•</p>
                                           <p className="text-lg font-semibold">{formatDateJP(profile.hireDate)}</p>
                                        </div>
                                    </div>
                                </div>

                                <table className="w-full border-collapse border border-slate-800 text-sm">
                                    <thead className="bg-slate-100">
                                        <tr>
                                            <th className="border border-slate-400 p-2 w-24">Âπ¥Â∫¶</th>
                                            <th className="border border-slate-400 p-2 w-12">Âπ¥Ê¨°</th>
                                            <th className="border border-slate-400 p-2">ÁµÑÁπî„ÉªÈÉ®ÁΩ≤„ÉªÂΩπËÅ∑</th>
                                            <th className="border border-slate-400 p-2 w-20">ÈöéÁ¥ö</th>
                                            <th className="border border-slate-400 p-2 w-20">Ë°åÊîøËÅ∑Âêç</th>
                                            <th className="border border-slate-400 p-2 w-1/4">‰∫ãÈ†ÖÔºàÁ†î‰øÆ„ÉªË°®ÂΩ∞„ÉªË≥áÊ†ºÔºâ</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {history.filter(h => h.orgName || h.events || h.awards || h.licenses).map((item) => (
                                            <tr key={item.id} style={{ pageBreakInside: 'avoid' }}>
                                                <td className="border border-slate-400 p-2 text-center align-top">
                                                    <div className="font-bold">{getWareki(item.fiscalYear)}</div>
                                                    <div className="text-xs text-slate-500">({item.fiscalYear})</div>
                                                </td>
                                                <td className="border border-slate-400 p-2 text-center align-top">{item.yearIndex}</td>
                                                <td className="border border-slate-400 p-2 align-top">
                                                    <div className="font-bold">{item.orgName}</div>
                                                    <div>{item.department} {item.section}</div>
                                                </td>
                                                <td className="border border-slate-400 p-2 text-center align-top">{item.rank}</td>
                                                <td className="border border-slate-400 p-2 text-center align-top">{item.adminTitle}</td>
                                                <td className="border border-slate-400 p-2 align-top">
                                                    {item.events && <div className="mb-1">„ÄêÁ†î‰øÆÁ≠â„Äë{item.events}</div>}
                                                    {item.awards && <div className="mb-1 font-semibold text-slate-800">„ÄêË°®ÂΩ∞„Äë{item.awards}</div>}
                                                    {item.licenses && <div className="font-semibold text-green-900">„ÄêË≥áÊ†º„Äë{item.licenses}</div>}
                                                </td>
                                            </tr>
                                        ))}
                                    </tbody>
                                </table>
                                
                                <div className="mt-8 text-center no-print space-y-4">
                                    <div className="p-4 bg-slate-50 rounded-lg border border-slate-200 inline-block text-left max-w-lg">
                                        <p className="text-sm font-bold text-slate-700 mb-2">üí° Âç∞Âà∑„Éª‰øùÂ≠ò„ÅÆ„Éí„É≥„Éà</p>
                                        <p className="text-sm text-slate-600 mb-2">
                                            ‰∏ã„ÅÆ„ÄåÂç∞Âà∑ÔºàPDF‰øùÂ≠òÔºâ„Äç„Éú„Çø„É≥„ÇíÊäº„Åó„ÅüÂæå„ÄÅÈÄÅ‰ø°ÂÖàÔºà„Éó„É™„É≥„Çø„ÉºÔºâ„ÅÆË®≠ÂÆö„Åß
                                            <span className="font-bold text-slate-900">„ÄåPDF„Å´‰øùÂ≠ò„Äç</span>
                                            „ÇíÈÅ∏Êäû„Åô„Çã„Å®„ÄÅ„Éá„Éº„Çø„Å®„Åó„Å¶‰øùÂ≠ò„Åß„Åç„Åæ„Åô„ÄÇ
                                        </p>
                                    </div>
                                    
                                    <div className="flex justify-center gap-4">
                                        <button 
                                            onClick={() => switchTab('list')}
                                            className="bg-white text-slate-600 border border-slate-300 px-6 py-2 rounded shadow-sm hover:bg-slate-50 flex items-center gap-2"
                                        >
                                            <ArrowLeft size={18} /> Á∑®ÈõÜ„Å´Êàª„Çã
                                        </button>
                                        <button 
                                            onClick={handlePrint}
                                            className="bg-slate-800 text-white px-6 py-2 rounded shadow hover:bg-slate-700 flex items-center gap-2"
                                        >
                                            <Printer size={18} /> Âç∞Âà∑ÔºàPDF‰øùÂ≠òÔºâ
                                        </button>
                                    </div>
                                </div>
                            </div>
                        )}
                    </main>

                    {editModalOpen && currentEditItem && (
                        <div className="fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 overflow-y-auto print:hidden">
                            <div className="bg-white rounded-xl shadow-2xl w-full max-w-lg overflow-hidden flex flex-col max-h-[90vh]">
                                <div className="p-4 bg-slate-900 text-white flex justify-between items-center flex-shrink-0">
                                    <h3 className="font-bold text-lg">
                                        {getWareki(currentEditItem.fiscalYear)}Âπ¥Â∫¶ <span className="text-sm font-normal text-slate-300">Ôºà{currentEditItem.yearIndex}Âπ¥ÁõÆÔºâ</span>„ÅÆÁ∑®ÈõÜ
                                    </h3>
                                    <button onClick={() => setEditModalOpen(false)} className="text-slate-400 hover:text-white">‚úï</button>
                                </div>
                                
                                <div className="p-6 overflow-y-auto space-y-4">
                                    <div className="space-y-4 pb-4 border-b border-slate-100">
                                        <h4 className="font-bold text-slate-700 flex items-center gap-2">
                                            <Building size={18} /> ÊâÄÂ±ûÊÉÖÂ†±
                                        </h4>
                                        <div>
                                            <label className="block text-xs font-bold text-slate-500 mb-1">Ê∂àÈò≤Êú¨ÈÉ®Âêç</label>
                                            <input 
                                                type="text" 
                                                className="w-full p-2 border border-slate-300 rounded focus:ring-2 focus:ring-orange-500 outline-none"
                                                value={currentEditItem.orgName}
                                                onChange={(e) => setCurrentEditItem({...currentEditItem, orgName: e.target.value})}
                                            />
                                        </div>
                                        <div className="grid grid-cols-2 gap-4">
                                            <div>
                                                <label className="block text-xs font-bold text-slate-500 mb-1">ÊâÄÂ±ûÔºàÁΩ≤„ÉªÊâÄÔºâ</label>
                                                <input 
                                                    type="text" 
                                                    className="w-full p-2 border border-slate-300 rounded focus:ring-2 focus:ring-orange-500 outline-none"
                                                    value={currentEditItem.department}
                                                    onChange={(e) => setCurrentEditItem({...currentEditItem, department: e.target.value})}
                                                />
                                            </div>
                                            <div>
                                                <label className="block text-xs font-bold text-slate-500 mb-1">ÊãÖÂΩìÔºàË™≤„Éª‰øÇ„ÉªÈöäÔºâ</label>
                                                <input 
                                                    type="text" 
                                                    className="w-full p-2 border border-slate-300 rounded focus:ring-2 focus:ring-orange-500 outline-none"
                                                    value={currentEditItem.section}
                                                    onChange={(e) => setCurrentEditItem({...currentEditItem, section: e.target.value})}
                                                />
                                            </div>
                                        </div>
                                    </div>

                                    <div className="space-y-4 pb-4 border-b border-slate-100">
                                        <h4 className="font-bold text-slate-700 flex items-center gap-2">
                                            <User size={18} /> ÈöéÁ¥ö„ÉªÂΩπËÅ∑
                                        </h4>
                                        <div className="grid grid-cols-2 gap-4">
                                            <div>
                                                <label className="block text-xs font-bold text-slate-500 mb-1">Ê∂àÈò≤ÈöéÁ¥ö</label>
                                                <select 
                                                    className="w-full p-2 border border-slate-300 rounded focus:ring-2 focus:ring-orange-500 outline-none"
                                                    value={currentEditItem.rank}
                                                    onChange={(e) => setCurrentEditItem({...currentEditItem, rank: e.target.value})}
                                                >
                                                    <option value="">ÈÅ∏Êäû„Å™„Åó</option>
                                                    {RANKS.map(r => <option key={r} value={r}>{r}</option>)}
                                                </select>
                                            </div>
                                            <div>
                                                <label className="block text-xs font-bold text-slate-500 mb-1">Ë°åÊîøËÅ∑Âêç</label>
                                                <input 
                                                    list="admin-titles"
                                                    className="w-full p-2 border border-slate-300 rounded focus:ring-2 focus:ring-orange-500 outline-none"
                                                    value={currentEditItem.adminTitle}
                                                    onChange={(e) => setCurrentEditItem({...currentEditItem, adminTitle: e.target.value})}
                                                />
                                                <datalist id="admin-titles">
                                                    {ADMIN_TITLES.map(t => <option key={t} value={t} />)}
                                                </datalist>
                                            </div>
                                        </div>
                                    </div>

                                    <div className="space-y-4">
                                        <h4 className="font-bold text-slate-700 flex items-center gap-2">
                                            <BookOpen size={18} /> Â±•Ê≠¥‰∫ãÈ†Ö
                                        </h4>
                                        <div>
                                            <label className="block text-xs font-bold text-slate-500 mb-1">Á†î‰øÆ„ÉªÂÖ•Ê†°„ÉªÁï∞ÂãïÁâπË®ò</label>
                                            <textarea 
                                                className="w-full p-2 border border-slate-300 rounded focus:ring-2 focus:ring-orange-500 outline-none h-20"
                                                value={currentEditItem.events}
                                                onChange={(e) => setCurrentEditItem({...currentEditItem, events: e.target.value})}
                                            />
                                        </div>
                                        <div>
                                            <label className="block text-xs font-bold text-slate-500 mb-1 text-yellow-600">Ë°®ÂΩ∞„ÉªÁâπÂà•‰∫ãÈ†Ö</label>
                                            <textarea 
                                                className="w-full p-2 border border-yellow-300 bg-yellow-50 rounded focus:ring-2 focus:ring-yellow-500 outline-none h-20"
                                                value={currentEditItem.awards}
                                                onChange={(e) => setCurrentEditItem({...currentEditItem, awards: e.target.value})}
                                            />
                                        </div>
                                        <div>
                                            <label className="block text-xs font-bold text-slate-500 mb-1 text-green-600">ÂèñÂæóË≥áÊ†º„ÉªÂÖçË®±</label>
                                            <textarea 
                                                className="w-full p-2 border border-green-300 bg-green-50 rounded focus:ring-2 focus:ring-green-500 outline-none h-20"
                                                value={currentEditItem.licenses || ''}
                                                onChange={(e) => setCurrentEditItem({...currentEditItem, licenses: e.target.value})}
                                                placeholder="Â§ßÂûãËá™ÂãïËªäÂÖçË®±&#13;&#10;Âç±Èô∫Áâ©ÂèñÊâ±ËÄÖ‰πôÁ®Æ4È°û"
                                            />
                                        </div>
                                    </div>
                                </div>

                                <div className="p-4 bg-slate-50 border-t border-slate-200 flex justify-end gap-2 flex-shrink-0">
                                    <button 
                                        onClick={() => setEditModalOpen(false)}
                                        className="px-4 py-2 text-slate-600 hover:bg-slate-200 rounded"
                                    >
                                        „Ç≠„É£„É≥„Çª„É´
                                    </button>
                                    <button 
                                        onClick={saveEdit}
                                        className="px-6 py-2 bg-orange-600 text-white rounded font-bold hover:bg-orange-700 shadow"
                                    >
                                        ‰øùÂ≠ò„Åô„Çã
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {deleteConfirmOpen && (
                        <div className="fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4 print:hidden">
                            <div className="bg-white rounded-xl shadow-xl w-full max-w-sm overflow-hidden p-6 text-center">
                                <div className="mx-auto w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mb-4 text-red-600">
                                    <AlertTriangle size={24} />
                                </div>
                                <h3 className="text-lg font-bold text-slate-800 mb-2">ÂÖ®„Éá„Éº„Çø„ÇíÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü</h3>
                                <p className="text-sm text-slate-600 mb-6">
                                    ÂÖ•Âäõ„Åó„ÅüÂ±•Ê≠¥„Å®„Éó„É≠„Éï„Ç£„Éº„É´„ÅåÂÖ®„Å¶Ê∂àÂéª„Åï„Çå„Åæ„Åô„ÄÇ„Åì„ÅÆÊìç‰Ωú„ÅØÂÖÉ„Å´Êàª„Åõ„Åæ„Åõ„Çì„ÄÇ
                                </p>
                                <div className="flex gap-3">
                                    <button 
                                        onClick={() => setDeleteConfirmOpen(false)}
                                        className="flex-1 py-2 text-slate-600 bg-slate-100 hover:bg-slate-200 rounded-lg font-medium"
                                    >
                                        „Ç≠„É£„É≥„Çª„É´
                                    </button>
                                    <button 
                                        onClick={executeReset}
                                        className="flex-1 py-2 text-white bg-red-600 hover:bg-red-700 rounded-lg font-bold"
                                    >
                                        ÂÆåÂÖ®„Å´ÂâäÈô§
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<FireCareerLog />);
    </script>
</body>
</html>
